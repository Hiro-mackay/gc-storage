# GC Storage éšœå®³å¯¾å¿œã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€GC Storageã§ç™ºç”Ÿã—ã†ã‚‹éšœå®³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ‰‹é †ã€ãŠã‚ˆã³ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

---

## 1. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡

### 1.1 é‡å¤§åº¦ãƒ¬ãƒ™ãƒ«

| ãƒ¬ãƒ™ãƒ« | åç§° | å®šç¾© | ç›®æ¨™å¾©æ—§æ™‚é–“ |
|--------|------|------|-------------|
| P1 | Critical | ã‚µãƒ¼ãƒ“ã‚¹å…¨åœæ­¢ã€ãƒ‡ãƒ¼ã‚¿æå¤±ã®å¯èƒ½æ€§ | 1æ™‚é–“ä»¥å†… |
| P2 | High | ä¸»è¦æ©Ÿèƒ½ã®åœæ­¢ã€å¤§è¦æ¨¡ãƒ¦ãƒ¼ã‚¶ãƒ¼å½±éŸ¿ | 4æ™‚é–“ä»¥å†… |
| P3 | Medium | ä¸€éƒ¨æ©Ÿèƒ½ã®éšœå®³ã€é™å®šçš„ãªå½±éŸ¿ | 24æ™‚é–“ä»¥å†… |
| P4 | Low | è»½å¾®ãªå•é¡Œã€å›é¿ç­–ã‚ã‚Š | 1é€±é–“ä»¥å†… |

### 1.2 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆä¾‹

| ãƒ¬ãƒ™ãƒ« | ä¾‹ |
|--------|-----|
| P1 | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šä¸å¯ã€å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ä¸å¯ |
| P2 | ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—ã€ç‰¹å®šãƒªãƒ¼ã‚¸ãƒ§ãƒ³éšœå®³ |
| P3 | æ¤œç´¢æ©Ÿèƒ½ã®é…å»¶ã€ä¸€éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæœŸã‚¨ãƒ©ãƒ¼ |
| P4 | UIã®è¡¨ç¤ºå´©ã‚Œã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®èª¤å­— |

---

## 2. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼

### 2.1 ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæ¤œçŸ¥                              â”‚
â”‚        (ã‚¢ãƒ©ãƒ¼ãƒˆ / ãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Š / ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       é‡å¤§åº¦ã®åˆ¤å®š                                   â”‚
â”‚                   (P1 / P2 / P3 / P4)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                   â”‚                   â”‚
            â–¼                   â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  P1/P2        â”‚   â”‚     P3        â”‚   â”‚     P4        â”‚
    â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
    â”‚  å³æ™‚å¯¾å¿œ     â”‚   â”‚  é€šå¸¸å¯¾å¿œ     â”‚   â”‚  è¨ˆç”»å¯¾å¿œ     â”‚
    â”‚  å…¨å“¡æ‹›é›†     â”‚   â”‚  æ‹…å½“è€…å¯¾å¿œ   â”‚   â”‚  ãƒãƒƒã‚¯ãƒ­ã‚°   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¯¾å¿œé–‹å§‹                                        â”‚
â”‚  1. çŠ¶æ³ç¢ºèª  2. å½±éŸ¿ç¯„å›²ç‰¹å®š  3. ç·Šæ€¥å¯¾å¿œ  4. æ ¹æœ¬åŸå› èª¿æŸ»            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¾©æ—§å®Œäº†                                        â”‚
â”‚  1. å‹•ä½œç¢ºèª  2. ç›£è¦–å¼·åŒ–  3. é–¢ä¿‚è€…é€šçŸ¥  4. ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 é€£çµ¡å…ˆ

| å½¹å‰² | æ‹…å½“ | é€£çµ¡æ‰‹æ®µ |
|------|------|---------|
| ä¸€æ¬¡å¯¾å¿œ | ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ | Slack #incident-alerts |
| ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | ãƒ†ãƒƒã‚¯ãƒªãƒ¼ãƒ‰ | é›»è©± / Slack |
| ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ | ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ | é›»è©± |
| çµŒå–¶å±¤ | CTO | P1ã®ã¿ã€é›»è©± |

### 2.3 ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

**ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿæ™‚:**
```
ğŸš¨ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿ

é‡å¤§åº¦: P[1-4]
ç™ºç”Ÿæ™‚åˆ»: YYYY-MM-DD HH:MM (JST)
å½±éŸ¿: [å½±éŸ¿ç¯„å›²ã®èª¬æ˜]
ç¾çŠ¶: [ç¾åœ¨ã®çŠ¶æ³]
å¯¾å¿œè€…: @æ‹…å½“è€…
```

**é€²æ—å ±å‘Š:**
```
ğŸ“Š ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé€²æ—å ±å‘Š

æ™‚åˆ»: YYYY-MM-DD HH:MM (JST)
çŠ¶æ³: [èª¿æŸ»ä¸­ / å¯¾å¿œä¸­ / å¾©æ—§ä¸­]
é€²æ—: [å®Ÿæ–½ã—ãŸå†…å®¹]
æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: [äºˆå®šã—ã¦ã„ã‚‹å¯¾å¿œ]
```

**å¾©æ—§å ±å‘Š:**
```
âœ… ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¾©æ—§å®Œäº†

å¾©æ—§æ™‚åˆ»: YYYY-MM-DD HH:MM (JST)
åœæ­¢æ™‚é–“: Xæ™‚é–“Yåˆ†
æ ¹æœ¬åŸå› : [ç°¡æ½”ãªèª¬æ˜]
å†ç™ºé˜²æ­¢: [äºˆå®šã—ã¦ã„ã‚‹å¯¾ç­–]
ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ : [ãƒªãƒ³ã‚¯]
```

---

## 3. ä¸€èˆ¬çš„ãªéšœå®³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å¿œ

### 3.1 API ã‚µãƒ¼ãƒãƒ¼å¿œç­”ãªã—

**ç—‡çŠ¶:**
- ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¤±æ•—
- 502/503 ã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. Pod ã®çŠ¶æ…‹ç¢ºèª
kubectl get pods -n gc-storage -l component=api

# 2. Pod ã®è©³ç´°ç¢ºèª
kubectl describe pod <pod-name> -n gc-storage

# 3. ãƒ­ã‚°ç¢ºèª
kubectl logs <pod-name> -n gc-storage --tail=100

# 4. ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³
kubectl top pod <pod-name> -n gc-storage
```

**å¯¾å¿œ:**
```bash
# Pod ã®å†èµ·å‹•
kubectl rollout restart deployment/api -n gc-storage

# ç‰¹å®š Pod ã®å‰Šé™¤ï¼ˆå†ä½œæˆã•ã‚Œã‚‹ï¼‰
kubectl delete pod <pod-name> -n gc-storage

# ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—
kubectl scale deployment/api --replicas=5 -n gc-storage
```

### 3.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
- "connection refused" ã‚¨ãƒ©ãƒ¼
- "too many connections" ã‚¨ãƒ©ãƒ¼
- ã‚¯ã‚¨ãƒªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. PostgreSQL Pod ã®ç¢ºèª
kubectl get pods -n gc-storage -l component=postgres

# 2. æ¥ç¶šæ•°ã®ç¢ºèª
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "SELECT count(*) FROM pg_stat_activity;"

# 3. ãƒ­ãƒƒã‚¯çŠ¶æ³ã®ç¢ºèª
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "SELECT * FROM pg_locks WHERE NOT granted;"

# 4. ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã®ç¢ºèª
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "SELECT pid, now() - pg_stat_activity.query_start AS duration, query FROM pg_stat_activity WHERE state = 'active' ORDER BY duration DESC LIMIT 10;"
```

**å¯¾å¿œ:**
```bash
# é•·æ™‚é–“ã‚¯ã‚¨ãƒªã®å¼·åˆ¶çµ‚äº†
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "SELECT pg_terminate_backend(PID);"

# æ¥ç¶šã®ãƒªã‚»ãƒƒãƒˆï¼ˆå…¨ API Pod å†èµ·å‹•ï¼‰
kubectl rollout restart deployment/api -n gc-storage

# PostgreSQL ã®å†èµ·å‹•ï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰
kubectl rollout restart statefulset/postgres -n gc-storage
```

### 3.3 Redis éšœå®³

**ç—‡çŠ¶:**
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç¶­æŒã•ã‚Œãªã„
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã®ä½ä¸‹
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒæ©Ÿèƒ½ã—ãªã„

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. Redis Pod ã®ç¢ºèª
kubectl get pods -n gc-storage -l component=redis

# 2. Redis ã®çŠ¶æ…‹ç¢ºèª
kubectl exec -n gc-storage deployment/redis -- redis-cli ping
kubectl exec -n gc-storage deployment/redis -- redis-cli info

# 3. ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³
kubectl exec -n gc-storage deployment/redis -- redis-cli info memory
```

**å¯¾å¿œ:**
```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢ï¼ˆæ…é‡ã«ï¼‰
kubectl exec -n gc-storage deployment/redis -- redis-cli FLUSHDB

# Redis ã®å†èµ·å‹•
kubectl rollout restart statefulset/redis -n gc-storage
```

### 3.4 MinIO / ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸éšœå®³

**ç—‡çŠ¶:**
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¤±æ•—
- Presigned URL ã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. MinIO Pod ã®ç¢ºèª
kubectl get pods -n gc-storage -l component=minio

# 2. MinIO ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://minio.gc-storage.svc:9000/minio/health/live
curl http://minio.gc-storage.svc:9000/minio/health/ready

# 3. ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨çŠ¶æ³
kubectl exec -n gc-storage minio-0 -- df -h /data
```

**å¯¾å¿œ:**
```bash
# MinIO Pod ã®å†èµ·å‹•
kubectl rollout restart statefulset/minio -n gc-storage

# ç‰¹å®šãƒãƒ¼ãƒ‰ã®å•é¡Œã®å ´åˆ
kubectl delete pod minio-X -n gc-storage
```

### 3.5 é«˜ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·

**ç—‡çŠ¶:**
- API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé…ã„
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. API ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç¢ºèªï¼ˆGrafanaï¼‰
# http_request_duration_seconds ã®P95/P99ã‚’ç¢ºèª

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒª
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "SELECT * FROM pg_stat_statements ORDER BY total_time DESC LIMIT 10;"

# 3. ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³
kubectl top pods -n gc-storage
kubectl top nodes
```

**å¯¾å¿œ:**
```bash
# ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢
kubectl exec -n gc-storage deployment/redis -- redis-cli FLUSHDB

# æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®æ‹¡å¼µï¼ˆè¨­å®šå¤‰æ›´å¾Œã«å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
# DB_MAX_CONNECTIONS ã‚’å¢—åŠ 

# ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—
kubectl scale deployment/api --replicas=5 -n gc-storage
```

### 3.6 èªè¨¼éšœå®³

**ç—‡çŠ¶:**
- ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„
- ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ã‚¨ãƒ©ãƒ¼
- OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †:**
```bash
# 1. JWT ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ç¢ºèª
kubectl get secret jwt-secret -n gc-storage

# 2. OAuth è¨­å®šã®ç¢ºèª
kubectl get secret oauth-secret -n gc-storage

# 3. Redisï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆã‚¢ï¼‰ã®ç¢ºèª
kubectl exec -n gc-storage deployment/redis -- redis-cli keys "session:*"
```

**å¯¾å¿œ:**
```bash
# ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¯ãƒªã‚¢ï¼ˆå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å†ãƒ­ã‚°ã‚¤ãƒ³å¿…è¦ï¼‰
kubectl exec -n gc-storage deployment/redis -- \
  redis-cli keys "session:*" | xargs redis-cli del

# API ã®å†èµ·å‹•
kubectl rollout restart deployment/api -n gc-storage
```

### 3.7 ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³

**ç—‡çŠ¶:**
- "no space left on device" ã‚¨ãƒ©ãƒ¼
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›¸ãè¾¼ã¿å¤±æ•—

**è¨ºæ–­æ‰‹é †:**
```bash
# PVC ã®ä½¿ç”¨çŠ¶æ³
kubectl get pvc -n gc-storage

# Pod å†…ã®ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨çŠ¶æ³
kubectl exec -n gc-storage deployment/postgres -- df -h
```

**å¯¾å¿œ:**
```bash
# ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
kubectl exec -n gc-storage deployment/postgres -- \
  psql -U gc_storage -c "VACUUM FULL;"

# PVC ã®æ‹¡å¼µ
kubectl patch pvc postgres-data -n gc-storage \
  -p '{"spec":{"resources":{"requests":{"storage":"200Gi"}}}}'

# å¤ã„ãƒ­ã‚°ã®å‰Šé™¤
kubectl exec -n gc-storage deployment/api -- \
  find /var/log -type f -mtime +7 -delete
```

---

## 4. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †

### 4.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

```bash
# 1. ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå±¥æ­´ç¢ºèª
kubectl rollout history deployment/api -n gc-storage

# 2. ç›´å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¸ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
kubectl rollout undo deployment/api -n gc-storage

# 3. ç‰¹å®šãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¸ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
kubectl rollout undo deployment/api -n gc-storage --to-revision=N

# 4. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯çŠ¶æ³ç¢ºèª
kubectl rollout status deployment/api -n gc-storage
```

### 4.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

```bash
# 1. ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢
kubectl scale deployment/api --replicas=0 -n gc-storage

# 2. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
kubectl exec -n gc-storage deployment/api -- \
  /app/migrate -path /app/migrations -database "$DATABASE_URL" down 1

# 3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒï¼ˆå¿…è¦ãªå ´åˆï¼‰
# See: OPERATIONS.md ã®å¾©å…ƒæ‰‹é †

# 4. ã‚µãƒ¼ãƒ“ã‚¹å†é–‹
kubectl scale deployment/api --replicas=3 -n gc-storage
```

---

## 5. ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ 

### 5.1 ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
# ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ 

## æ¦‚è¦
- **æ—¥æ™‚**: YYYY-MM-DD HH:MM - HH:MM (JST)
- **å½±éŸ¿æ™‚é–“**: Xæ™‚é–“Yåˆ†
- **é‡å¤§åº¦**: P[1-4]
- **å½±éŸ¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°**: ç´„ N äºº

## ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³

| æ™‚åˆ» | ã‚¤ãƒ™ãƒ³ãƒˆ |
|------|---------|
| HH:MM | æœ€åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆç™ºç”Ÿ |
| HH:MM | ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒå¯¾å¿œé–‹å§‹ |
| HH:MM | åŸå› ç‰¹å®š |
| HH:MM | å¾©æ—§å®Œäº† |

## æ ¹æœ¬åŸå› 

[æŠ€è¡“çš„ãªæ ¹æœ¬åŸå› ã®èª¬æ˜]

## å½±éŸ¿

- [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿]
- [ãƒ“ã‚¸ãƒã‚¹ã¸ã®å½±éŸ¿]

## å¯¾å¿œå†…å®¹

1. [å®Ÿæ–½ã—ãŸå¯¾å¿œ1]
2. [å®Ÿæ–½ã—ãŸå¯¾å¿œ2]

## ã†ã¾ãã„ã£ãŸã“ã¨

- [è‰¯ã‹ã£ãŸç‚¹]

## æ”¹å–„ã™ã¹ãã“ã¨

- [æ”¹å–„ç‚¹]

## ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 

| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | æ‹…å½“ | æœŸé™ |
|-----------|------|------|
| [å¯¾ç­–1] | @æ‹…å½“ | YYYY-MM-DD |
| [å¯¾ç­–2] | @æ‹…å½“ | YYYY-MM-DD |

## å­¦ã³

[ä»Šå›ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ•™è¨“]
```

### 5.2 ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ãƒ«ãƒ¼ãƒ«

1. **è²¬ä»»è¿½åŠã—ãªã„ï¼ˆBlamelessï¼‰**: å€‹äººã‚’è²¬ã‚ãšã€ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„ã«ç„¦ç‚¹
2. **è¿…é€Ÿã«å®Ÿæ–½**: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¾Œ 1 é€±é–“ä»¥å†…
3. **åºƒãå…±æœ‰**: ãƒãƒ¼ãƒ å…¨ä½“ã§å­¦ã³ã‚’å…±æœ‰
4. **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½è·¡**: å†ç™ºé˜²æ­¢ç­–ã®å®Ÿè¡Œã‚’ç¢ºèª

---

## 6. éšœå®³å¯¾å¿œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### 6.1 åˆå‹•å¯¾å¿œ

```
â–¡ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®èªè­˜ãƒ»è¨˜éŒ²
â–¡ é‡å¤§åº¦ã®åˆ¤å®š
â–¡ é©åˆ‡ãªæ‹…å½“è€…ã¸ã®é€£çµ¡
â–¡ çŠ¶æ³ç¢ºèªã®é–‹å§‹
â–¡ å½±éŸ¿ç¯„å›²ã®ç‰¹å®š
â–¡ é–¢ä¿‚è€…ã¸ã®åˆæœŸå ±å‘Š
```

### 6.2 å¯¾å¿œä¸­

```
â–¡ å®šæœŸçš„ãªé€²æ—å ±å‘Šï¼ˆ15-30åˆ†ã”ã¨ï¼‰
â–¡ å¯¾å¿œãƒ­ã‚°ã®è¨˜éŒ²
â–¡ å¿…è¦ã«å¿œã˜ã¦ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â–¡ å¾©æ—§ä½œæ¥­ã®å®Ÿæ–½
â–¡ å¾©æ—§ç¢ºèªãƒ†ã‚¹ãƒˆ
```

### 6.3 å¾©æ—§å¾Œ

```
â–¡ å¾©æ—§å®Œäº†ã®å ±å‘Š
â–¡ ç›£è¦–ã®å¼·åŒ–
â–¡ é–¢ä¿‚è€…ã¸ã®æœ€çµ‚å ±å‘Š
â–¡ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ä½œæˆ
â–¡ å†ç™ºé˜²æ­¢ç­–ã®å®Ÿæ–½
```

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [OPERATIONS.md](./OPERATIONS.md) - é‹ç”¨ã‚¬ã‚¤ãƒ‰
- [DEPLOYMENT.md](./DEPLOYMENT.md) - ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ‰‹é †
- [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å†…å®¹ |
|------|-----------|------|
| 2026-01-17 | 1.0.0 | åˆç‰ˆä½œæˆ |
